#!/usr/bin/env python

from random import randint, shuffle

from footyhints.models.team import Team
from footyhints.models.round import Round
from footyhints.models.game import Game

from footyhints.db import session, create_db, delete_db

print("Setting up DB")
delete_db()
create_db()

teams = [
    'Chelsea',
    'Tottenham Hotspur',
    'Manchester City',
    'Liverpool',
    'Arsenal',
    'Manchester United',
    'Everton',
    'Southampton',
    'Bournemouth',
    'West Bromwich Albion',
    'West Ham United',
    'Leicester City',
    'Stoke City',
    'Crystal Palace',
    'Swansea City',
    'Burnley',
    'Watford',
    'Hull City',
    'Middlesbrough',
    'Sunderland',
]

num_rounds = randint(1, 38)
for num in range(1, num_rounds + 1):
    temp_teams = [team[:] for team in teams]
    shuffle(temp_teams)
    round = Round(num)
    print("Match Day: {}".format(round.num))
    while len(temp_teams) != 0:
        home_team_name = temp_teams.pop()
        away_team_name = temp_teams.pop()
        home_team = Team(name=home_team_name)
        away_team = Team(name=away_team_name)
        game = Game(home_team=home_team, away_team=away_team, round=round)
        game.set_score(randint(0, randint(0, 7)), randint(0, randint(0, 7)))
        print("\tCreating game\t{0} | {1}\t{2}-{3}".format(home_team_name, away_team_name, game.home_team_score, game.away_team_score))
        session.add(game)
    session.add(round)
    session.commit()
