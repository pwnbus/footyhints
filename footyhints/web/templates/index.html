{% extends 'base.html' %}
{% block title %}Index{% endblock %}
{% block head %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.dataTables.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.min.css') }}"></script>
{% endblock %}
{% block content %}
<table id='game_list' class="table table-striped table-bordered table-compact" style="clear: both">
  <thead>
    <th>Home Team</th>
    <th>Away Team</th>
    <th>Match Day</th>
    <th>Interest Level</th>
    <th>Interest Score</th>
  </thead>
  <tbody>
    {% for game in games %}
      <div id="gameModal{{game.id}}" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title">Scoring Reasons</h4>
            </div>
            <div class="modal-body">
              <div>
              {% for score_modification in game.score_modifications %}
                {% if score_modification.value != 0 %}
                  <div style="float: left;">
                  {% if score_modification.value > 0 %}
                    <span class="glyphicon glyphicon-arrow-up" style="color:green"/>
                  {% elif score_modification.value < 0 %}
                    <span class="glyphicon glyphicon-arrow-down" style="color:red"/>
                  {% endif %}
                  </div>
                  <div style="margin: 0 0 0 30px;">{{score_modification.description}}</div>
                {% endif %}
              {% endfor %}
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      <tr>
        <td>{{game.home_team.name}}</td>
        <td>{{game.away_team.name}}</td>
        <td>{{game.round.num}}</td>
        <td>
          {% if game.interest_level == 'High' %}
            <a href="#gameModal{{game.id}}" class="label label-success" data-toggle="modal">High</a>
          {% elif game.interest_level == 'Medium' %}
            <a href="#gameModal{{game.id}}" class="label label-warning" data-toggle="modal">Medium</a>
          {% elif game.interest_level == 'Low' %}
            <a href="#gameModal{{game.id}}" class="label label-danger" data-toggle="modal">Low</a>
          {% endif %}
        </td>
        <td>{{game.interest_score}}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
<script>
  $(document).ready(function(){
    $('#game_list').DataTable({
      "columnDefs": [
        {
          "targets": [0,1,2,3],
          "bSortable": false,
        },
        {
          "targets": [4],
          "visible": false,
          "searchable": false
        },
      ],
      'order': [[2, 'desc'], [4, 'desc']],
      'paging': false,
      'bFilter': false,
      'bInfo': false,
    });
  });
</script>
{% endblock %}
