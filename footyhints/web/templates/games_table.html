<table id='game_list_new' class="table table-striped table-bordered table-compact" style="clear: both;margin-top: 20px;">
    <thead id="game_list_header">
    <thead/>
    <tbody>
      {% for game in games %}
        <tr>
          <td align="right"><a href="/team/{{ game.home_team_id }}">{{ game.home_team.name }}</a></td>
          <td align="left"><a href="/team/{{ game.away_team_id }}">{{ game.away_team.name }}</a></td>
          <td class="start_time">{{ game.start_time }}</td>
          <td align="center">
            {% include 'game_modal.html' %}
            {% include 'severity_badge.html' %}
          </td>
          <td>{{ game.date_from_start_time }}</td>
        </tr>
      {% endfor %}
    </tbody>
</table>

{% if request.path.startswith('/team/') %}
  {% set displayLength = 9 %}
{% else %}
  {% set displayLength = 15 %}
{% endif %}

<script>
  $(document).ready( function () {
    $('#game_list_new').DataTable({
      "order": [[2, 'desc']],
      "autoWidth": false,
      "bFilter": false,
      "bInfo": false,
      "bLengthChange": false,
      "bPaginate": true,
      "iDisplayLength": "{{ displayLength }}",
      "fnDrawCallback": function() {
        $("#game_list_header").remove();
      },
      "columnDefs": [
        {
          "targets": [0,1,2,3],
          "bSortable": false,
          "createdCell": function (td, cellData, rowData, row, col) {
            if (col == 2){
              var start_time = new Date(cellData*1000);
              var locale = document.querySelector('html').getAttribute('lang')
              var options = {
                weekday: "short",
                month: "2-digit",
                day: "numeric",
              };
              $(td).html(start_time.toLocaleTimeString())
            }
          }
        },
        {
          "bVisible": false,
          "aTargets": [4]
        }
      ],
      "rowGroup": {
        "dataSrc": 4
      },
    });
  });
</script>
